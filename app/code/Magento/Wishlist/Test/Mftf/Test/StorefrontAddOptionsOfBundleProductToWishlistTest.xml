<?xml version="1.0" encoding="UTF-8"?>
<!--
 /**
  * Copyright Â© Magento, Inc. All rights reserved.
  * See COPYING.txt for license details.
  */
-->

<tests xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="urn:magento:mftf:Test/etc/testSchema.xsd">
    <test name="StorefrontAddOptionsOfBundleProductToWishlistTest">
        <annotations>
            <features value="Wishlist"/>
            <stories value="Checks options of bundle product in customer cabinet "/>
            <title value="Add Bundle product with checkbox options (checked and unchecked) to Wishlist on Frontend"/>
            <description value="Add Bundle product with checkbox options (checked and unchecked) to Wishlist on Frontend and compare options in the customer cabinet"/>
            <severity value="AVERAGE"/>
            <group value="wishlist"/>
        </annotations>

        <before>
            <createData entity="Simple_US_Customer_CA" stepKey="customer"/>
            <createData entity="ApiProductWithDescription" stepKey="simple1" before="simple2"/>
            <createData entity="ApiProductWithDescription" stepKey="simple2" before="simple3"/>
            <createData entity="ApiProductWithDescription" stepKey="simple3" before="product"/>
            <createData entity="ApiBundleProduct" stepKey="product"/>
            <createData entity="CheckboxOption" stepKey="checkboxBundleOption">
                <requiredEntity createDataKey="product"/>
            </createData>
            <createData entity="ApiBundleLink" stepKey="createBundleLink1">
                <requiredEntity createDataKey="product"/>
                <requiredEntity createDataKey="checkboxBundleOption"/>
                <requiredEntity createDataKey="simple1"/>
                <field key="qty">2</field>
            </createData>
            <createData entity="ApiBundleLink" stepKey="createBundleLink2">
                <requiredEntity createDataKey="product"/>
                <requiredEntity createDataKey="checkboxBundleOption"/>
                <requiredEntity createDataKey="simple2"/>
                <field key="qty">2</field>
            </createData>
            <createData entity="ApiBundleLink" stepKey="createBundleLink3">
                <requiredEntity createDataKey="product"/>
                <requiredEntity createDataKey="checkboxBundleOption"/>
                <requiredEntity createDataKey="simple3"/>
                <field key="qty">2</field>
            </createData>
            <actionGroup ref="CliIndexerReindexActionGroup" stepKey="reindex">
                <argument name="indices" value=""/>
            </actionGroup>
        </before>

        <after>
            <deleteData createDataKey="product" stepKey="delete"/>
            <deleteData createDataKey="simple1" stepKey="deleteSimple1" before="deleteSimple2"/>
            <deleteData createDataKey="simple2" stepKey="deleteSimple2" before="deleteSimple3"/>
            <deleteData createDataKey="simple3" stepKey="deleteSimple3" before="delete"/>
            <deleteData createDataKey="customer" stepKey="deleteCustomer"/>
        </after>

        <actionGroup ref="StorefrontOpenCustomerLoginPageActionGroup" stepKey="goToSignInPage"/>
        <actionGroup ref="StorefrontFillCustomerLoginFormActionGroup" stepKey="fillLoginFormWithCorrectCredentials">
            <argument name="customer" value="$$customer$$"/>
        </actionGroup>

        <actionGroup ref="StorefrontClickSignOnCustomerLoginFormActionGroup" stepKey="clickSignInAccountButton"/>

        <actionGroup ref="StorefrontOpenProductPageActionGroup" stepKey="openProductPage">
            <argument name="productUrl" value="$$product.sku$$"/>
        </actionGroup>

        <actionGroup ref="StorefrontCustomerClickAddToCartAndBundleCheckboxesActionGroup" stepKey="clickCustomizeAddToCartAndCheckboxes"/>

        <actionGroup ref="StorefrontCustomerAddProductToWishlistActionGroup" stepKey="addToWishlistProduct">
            <argument name="productVar" value="$$product$$"/>
        </actionGroup>

        <actionGroup ref="AssertProductDetailsInWishlistActionGroup" stepKey="assertProductDetails">
            <argument name="productName" value="$$product.name$$"/>
            <argument name="label" value="$$checkboxBundleOption.name$$"/>
            <argument name="labelValue" value="$$simple1.name$$"/>
        </actionGroup>

        <actionGroup ref="AssertProductDetailsIsNotInWishlistActionGroup"
                     stepKey="assertProductDetailsNotPresent2">
            <argument name="productName" value="$$product.name$$"/>
            <argument name="label" value="$$checkboxBundleOption.name$$"/>
            <argument name="labelValue" value="$$simple2.name$$"/>
        </actionGroup>

        <actionGroup ref="AssertProductDetailsIsNotInWishlistActionGroup"
                     stepKey="assertProductDetailsNotPresent3">
            <argument name="productName" value="$$product.name$$"/>
            <argument name="label" value="$$checkboxBundleOption.name$$"/>
            <argument name="labelValue" value="$$simple3.name$$"/>
        </actionGroup>

    </test>
</tests>