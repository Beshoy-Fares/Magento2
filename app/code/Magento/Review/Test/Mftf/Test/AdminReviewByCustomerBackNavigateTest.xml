<?xml version="1.0" encoding="UTF-8"?>
<!--
 /**
  * Copyright Â© Magento, Inc. All rights reserved.
  * See COPYING.txt for license details.
  */
-->

<tests xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:noNamespaceSchemaLocation="urn:magento:mftf:Test/etc/testSchema.xsd">
    <test name="AdminReviewByCustomerBackNavigateTest">
        <annotations>
            <features value="Review"/>
            <stories value="Review By Customers, Back button link"/>
            <title value="Review By Customers, Back button link."/>
            <description value="Customer back navigate from Product Review page."/>
            <severity value="AVERAGE"/>
        </annotations>

        <before>
            <!--Login-->
            <actionGroup ref="AdminLoginActionGroup" stepKey="LoginAsAdmin"/>
            <!--Create product and Category-->
            <createData stepKey="category" entity="SimpleSubCategory"/>
            <createData stepKey="createProduct1" entity="SimpleProduct">
                <requiredEntity createDataKey="category"/>
            </createData>
        </before>

        <after>
            <!-- Delete reviews -->
            <actionGroup ref="AdminOpenReviewsPageActionGroup" stepKey="openAllReviewsPage"/>
            <actionGroup ref="AdminDeleteReviewsByUserNicknameActionGroup" stepKey="deleteCustomerReview"/>
            <actionGroup ref="ClearFiltersAdminDataGridActionGroup" stepKey="clearNickNameReviewFilters"/>
            <!-- Delete customer -->
            <actionGroup ref="AdminDeleteCustomerActionGroup" stepKey="deleteCustomer">
                <argument name="customerEmail" value="CustomerEntityOne.email"/>
            </actionGroup>
            <!--delete Category and Products -->
            <deleteData createDataKey="createProduct1" stepKey="deleteProduct1"/>
            <deleteData createDataKey="category" stepKey="deleteCategory"/>
            <!--Logout-->
            <actionGroup ref="AdminLogoutActionGroup" stepKey="logout"/>
        </after>
        <!-- Go to frontend and make a user account and login with it -->
        <actionGroup ref="SignUpNewUserFromStorefrontActionGroup" stepKey="signUpNewUser">
            <argument name="Customer" value="CustomerEntityOne"/>
        </actionGroup>
        <!-- Go to the product view page -->
        <actionGroup ref="StorefrontOpenProductPageActionGroup" stepKey="openStorefrontProductPage">
            <argument name="productUrl" value="$$createProduct1.custom_attributes[url_key]$$"/>
        </actionGroup>
        <!-- Click on reviews and add  reviews with current user -->
        <actionGroup ref="StorefrontAddProductReviewActionGroup" stepKey="addReview"/>
        <!-- Go to Pending reviews page and clear filters -->
        <actionGroup ref="AdminOpenPendingReviewsPageActionGroup" stepKey="openReviewsPage"/>
        <actionGroup ref="ClearFiltersAdminDataGridActionGroup" stepKey="clearFilters"/>
        <!-- Open Review -->
        <actionGroup ref="AdminOpenReviewByUserNicknameActionGroup" stepKey="openReviewViewPage"/>
        <!-- Open Reviews Customer -->
        <actionGroup ref="AdminOpenReviewCustomerViewPageActionGroup" stepKey="openCustomerViewPage"/>
        <!-- Click on Back button -->
        <actionGroup ref="AdminBackToReviewPageActionGroup" stepKey="backToReviewPAge"/>
    </test>
</tests>
