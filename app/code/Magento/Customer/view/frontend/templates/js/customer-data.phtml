<?php
/**
 * Copyright Â© Magento, Inc. All rights reserved.
 * See COPYING.txt for license details.
 */
declare(strict_types=1);

use Magento\Customer\Block\CustomerData;
use Magento\Customer\ViewModel\Customer\Data;
use Magento\Framework\App\ObjectManager;
use Magento\Framework\Escaper;

/** @var Escaper $escaper */
/** @var CustomerData $block */
/** @var Data $viewModel */
$viewModel = $block->getViewModel() ?? ObjectManager::getInstance()->get(Data::class);
$customerDataUrl = $block->getCustomerDataUrl('customer/account/updateSession');
$expirableSectionNames = $block->getExpirableSectionNames();
?>
<script type="text/x-magento-init">
    {
        "*": {
            "Magento_Customer/js/customer-data": {
                "sectionLoadUrl": "<?= $escaper->escapeJs($block->getCustomerDataUrl('customer/section/load')) ?>",
                "expirableSectionLifetime": <?= (int)$block->getExpirableSectionLifetime() ?>,
                "expirableSectionNames": <?= /* @noEscape */ $viewModel->jsonEncode($expirableSectionNames) ?>,
                "cookieLifeTime": "<?= $escaper->escapeJs($block->getCookieLifeTime()) ?>",
                "updateSessionUrl": "<?= $escaper->escapeJs($customerDataUrl) ?>",
                "isLoggedIn": "<?= /* @noEscape */ $viewModel->isLoggedIn() ?>"
            }
        }
    }
</script>
