<?php
/**
 * Copyright Â© Magento, Inc. All rights reserved.
 * See COPYING.txt for license details.
 */
declare(strict_types=1);

use Magento\Customer\Block\Account\AuthenticationPopup;
use Magento\Customer\ViewModel\Customer\StoreConfig;
use Magento\Framework\Escaper;
use Magento\Framework\View\Helper\SecureHtmlRenderer;

/** @var Escaper $escaper */
/** @var SecureHtmlRenderer $secureRenderer */
/** @var AuthenticationPopup $block */
/** @var StoreConfig $viewModel */
$viewModel = $block->getViewModel();
?>
<div id="authenticationPopup" data-bind="scope:'authenticationPopup', style: {display: 'none'}">
    <?php $scriptString = 'window.authenticationPopup = ' . /* @noEscape */ $block->getSerializedConfig(); ?>
    <?= /* @noEscape */ $secureRenderer->renderTag('script', [], $scriptString, false); ?>
    <!-- ko template: getTemplate() --><!-- /ko -->
    <?php // phpcs:ignore Magento2.Legacy.PhtmlTemplate ?>
    <script type="text/x-magento-init">
        {
            "#authenticationPopup": {
                "Magento_Ui/js/core/app": <?= /* @noEscape */ $block->getJsLayout() ?>
            },
            "*": {
                "Magento_Ui/js/block-loader": "<?= $escaper->escapeJs($escaper->escapeUrl($block->getViewFileUrl(
                    'images/loader-1.gif'
                ))) ?>"
                <?php if ($viewModel->isGlobalScopeEnabled()): ?>
                ,
                "Magento_Customer/js/customer-global-session-loader": {}
                <?php endif; ?>
            }
        }
    </script>
</div>
