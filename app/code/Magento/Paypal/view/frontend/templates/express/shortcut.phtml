<?php
/**
 * Copyright Â© 2015 Magento. All rights reserved.
 * See COPYING.txt for license details.
 */

// @codingStandardsIgnoreFile
/**
 * @var \Magento\Paypal\Block\Express\Shortcut $block
 */
?>
<?php
$labelPosition = '';
if ($block->isOrPositionBefore()) {
    $labelPosition = ' before';
} elseif ($block->isOrPositionAfter()) {
    $labelPosition = ' after';
}
$shortcutHtmlId = $block->escapeHtml($block->getShortcutHtmlId());
$confirmationUrl = '';
$isInCatalogProduct = false;
if ($block->getConfirmationUrl() || $block->getIsInCatalogProduct()) {
    $confirmationUrl = $block->escapeUrl($block->getConfirmationUrl());
    $isInCatalogProduct = $block->getIsInCatalogProduct();
}
?>
<div data-label="<?php echo $block->escapeHtml(__('or')); ?>"
     class="paypal checkout <?php /* @noEscape */ echo $labelPosition; ?> paypal-logo
        <?php /* @noEscape */ echo $shortcutHtmlId; ?>"
     data-mage-init='{
     "paypalCheckout": {
                "confirmMessage": "<?php /* @noEscape */ echo $block->escapeJsQuote($block->getConfirmationMessage()); ?>",
                "confirmUrl": "<?php /* @noEscape */ echo !empty($confirmationUrl) ? $confirmationUrl : false; ?>",
                "isCatalogProduct": "<?php /* @noEscape */ echo !empty($isInCatalogProduct) ? (bool)$isInCatalogProduct : false;?>",
                "shortcutContainerClass": "<?php /* @noEscape */ echo "." . $shortcutHtmlId; ?>"
            }
     }'
    >
    <input type="image" data-action="checkout-form-submit"
           data-checkout-url="<?php echo $block->escapeUrl($block->getCheckoutUrl()); ?>"
           src="<?php echo $block->escapeUrl($block->getImageUrl()); ?>"
           alt="<?php echo $block->escapeHtml(__('Checkout with PayPal')); ?>"
           title="<?php echo $block->escapeHtml(__('Checkout with PayPal')); ?>"/>
    <?php if ($block->getAdditionalLinkImage()): ?>
        <?php $linkImage = $block->getAdditionalLinkImage(); ?>
        <a href="<?php echo $block->escapeUrl($linkImage['href']);?>">
            <img src="<?php echo $block->escapeHtml($linkImage['src']);?>" />
        </a>
    <?php endif; ?>
<script type="text/x-magento-init">
    {
        ".paypal-logo.<?php echo $shortcutHtmlId ?>": {
            "paypalCheckout": {
                "confirmMessage": "<?php echo $block->escapeJsQuote($block->getConfirmationMessage())?>",
                "confirmUrl": "<?php echo !empty($confirmationUrl) ? $confirmationUrl : false ?>",
                "isCatalogProduct": "<?php echo !empty($isInCatalogProduct) ? $isInCatalogProduct : false ?>",
                "paypalCheckoutSelector": "#pp-checkout-url",
                "shortcutContainerClass": "<?php echo "." . $shortcutHtmlId ?>"
            }
        }
    }
</script>
    <form id="myContainer" method="post" action="<?php echo $block->getCheckoutUrl() ?>"></form>
    <script>
        window.paypalCheckoutReady = function () {
            paypal.checkout.setup('HFCTQCHQ3JB8S', {
                environment: 'sandbox',
                container: 'myContainer'
            });
        };
    </script>
    <script>
        (function (d, t) {
            "use strict";
            var s = d.getElementsByTagName(t)[0], n = d.createElement(t);
            n.src = "//www.paypalobjects.com/api/checkout.js";
            s.parentNode.insertBefore(n, s);
        }(document, "script"));
    </script>
</div>
