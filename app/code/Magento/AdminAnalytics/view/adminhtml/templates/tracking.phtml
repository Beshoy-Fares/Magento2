<?php
/**
 * Copyright Â© Magento, Inc. All rights reserved.
 * See COPYING.txt for license details.
 */
declare(strict_types=1);

use Magento\Framework\Escaper;
use Magento\Framework\View\Helper\SecureHtmlRenderer;

/** @var Escaper $escaper */
/** @var SecureHtmlRenderer $secureRenderer */
?>

<?= /* @noEscape */ $secureRenderer->renderTag(
    'script',
    [
        'src' => $block->getTrackingUrl(),
        'async' => true,
    ],
    '&nbsp;',
    false
) ?>

<?php
/** @var \Magento\AdminAnalytics\ViewModel\Metadata $metadata */
$metadata = $block->getMetadata();
$scriptString = '
    var adminAnalyticsMetadata = {
        "secure_base_url": "' . $escaper->escapeJs($metadata->getSecureBaseUrlForScope()) . '",
        "version": "' . $escaper->escapeJs($metadata->getMagentoVersion()) . '",
        "product_edition": "' . $escaper->escapeJs($metadata->getProductEdition()) . '",
        "user": "' . $escaper->escapeJs($metadata->getCurrentUser()) . '",
        "mode": "' . $escaper->escapeJs($metadata->getMode()) . '",
        "store_name_default": "' . $escaper->escapeJs($metadata->getStoreNameForScope()) . '",
        "admin_user_created": "' . $escaper->escapeJs($metadata->getCurrentUserCreatedDate()) . '",
        "admin_user_logdate": "' . $escaper->escapeJs($metadata->getCurrentUserLogDate()) . '",
        "admin_user_role_name": "' . $escaper->escapeJs($metadata->getCurrentUserRoleName()) . '"
    };
';
?>
<?= /* @noEscape */ $secureRenderer->renderTag('script', [], $scriptString, false); ?>
