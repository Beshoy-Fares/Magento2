<svg version="1.1"
     xmlns="http://www.w3.org/2000/svg"
     xmlns:xlink="http://www.w3.org/1999/xlink"
     style="position: absolute; width: 0; height: 0;"
     width="0"
     height="0">
    <defs>
        <symbol id="svg-ending" viewBox="0 0 28 36">
            <path class="g__timeline-ending"
                  d="M2.864,0.456
                         h1.189 l14.625,17.55
                         L4.054,35.557
                         H2.681"/>
            <path class="g__timeline-arrow"
                  fill="currentColor"
                  d="M9.175,0.04
                         h4.002l15.006,18.007
                         L13.177,36.055
                         H9.175 l15.006-18.008
                         L9.175,0.04z"/>
        </symbol>
    </defs>
</svg>
<div class="admin__data-grid-header">
    <div class="admin__data-grid-header-row">
        <div class="data-grid-search-control-wrap">
            <label class="data-grid-search-label" title="Search" for="fulltext">
                <span>Search</span>
            </label>
            <input class="admin__control-text data-grid-search-control" type="text" id="fulltext" placeholder="Search by keyword">
            <button class="action-submit" type="button">
                <span>Search</span>
            </button>
        </div>
        <div class="timeline-legend">
            <span class="admin__control-support-text timeline-legend-item _active">Active</span>
            <span class="admin__control-support-text timeline-legend-item _upcoming">Upcoming</span>
        </div>
    </div>
</div>

<?php
// This code is for MAGETWO-41686 - Timeline priority scale
/*
<div class="timeline-priority">
    <div class="timeline-priority-title">Priority</div>
    <div class="timeline-priority-content">
        <div class="timeline-priority-heigh">High</div>
        <div class="timeline-priority-scale"></div> <!-- To arrange the scale height use style="border-top-width: <newHeight>px;"-->
        <div class="timeline-priority-low">Low</div>
    </div>
</div>
*/
?>

<div class="timeline">
    <div class="timeline-content _from-now">
        <div class="timeline-past">
            <time datetime="" class="timeline-date">Past</time>
        </div>
        <ul class="timeline-units">
            <li class="timeline-unit"><time datetime="" class="timeline-date">Today</time>
            <li class="timeline-unit"><time datetime="" class="timeline-date">Tue 01/21</time>
            <li class="timeline-unit"><time datetime="" class="timeline-date">Tue 01/21</time>
            <li class="timeline-unit"><time datetime="" class="timeline-date">Tue 01/21</time>
            <li class="timeline-unit"><time datetime="" class="timeline-date">Tue 01/21</time>
            <li class="timeline-unit"><time datetime="" class="timeline-date">Tue 01/21</time>
            <li class="timeline-unit"><time datetime="" class="timeline-date">Tue 01/21</time>
            <li class="timeline-unit"><time datetime="" class="timeline-date">Tue 01/21</time>
            <li class="timeline-unit"><time datetime="" class="timeline-date">Tue 01/21</time>
            <li class="timeline-unit"><time datetime="" class="timeline-date">Tue 01/21</time>
            <li class="timeline-unit"><time datetime="" class="timeline-date">Tue 01/21</time>
            <li class="timeline-unit"><time datetime="" class="timeline-date">Tue 01/21</time>
            <li class="timeline-unit"><time datetime="" class="timeline-date">Tue 01/21</time>
            <li class="timeline-unit"><time datetime="" class="timeline-date">Tue 01/21</time>
            <li class="timeline-unit"><time datetime="" class="timeline-date">Tue 01/21</time>
            <li class="timeline-unit"><time datetime="" class="timeline-date">Tue 01/21</time>
            <li class="timeline-unit"><time datetime="" class="timeline-date">Tue 01/21</time>
            <li class="timeline-unit"><time datetime="" class="timeline-date">Tue 01/21</time>
            <li class="timeline-unit"><time datetime="" class="timeline-date">Tue 01/21</time>
            <li class="timeline-unit"><time datetime="" class="timeline-date">Tue 01/21</time>
            <li class="timeline-unit"><time datetime="" class="timeline-date">Tue 01/21</time>
            <li class="timeline-unit"><time datetime="" class="timeline-date">Tue 01/21</time>
            <li class="timeline-unit"><time datetime="" class="timeline-date">Tue 01/21</time>
            <li class="timeline-unit"><time datetime="" class="timeline-date">Tue 01/21</time>
            <li class="timeline-unit"><time datetime="" class="timeline-date">Tue 01/21</time>
        </ul>
        <ul class="timeline-items">
            <li class="timeline-item test0">
                <div class="timeline-event">
                    <strong class="timeline-event-title">
                        Active Permanent Updates
                    </strong>
                    <div class="timeline-event-info">
                        <div class="timeline-event-details"></div>
                        <div class="timeline-event-summary"></div>
                    </div>
                    <div class="timeline-event-actions">
                        <button type="button" disabled class="timeline-action _tostart"><span>To start</span></button>
                        <button type="button" disabled class="timeline-action _toend"><span>To end</span></button>
                    </div>
                    <svg><use class="timeline-ending" xlink:href="#svg-ending"></use></svg>
                </div>
            </li>
            <li class="timeline-item test1">
                <div class="timeline-event">
                    <strong class="timeline-event-title">
                        Up to 60% Off Closeout
                    </strong>
                    <div class="timeline-event-info">
                        <div class="timeline-event-details"></div>
                        <div class="timeline-event-summary">
                            <div class="staging-events-campaign-objects-count">11</div>
                        </div>
                    </div>
                    <div class="timeline-event-actions">
                        <button type="button" disabled class="timeline-action _tostart"><span>To start</span></button>
                        <button type="button" disabled class="timeline-action _toend"><span>To end</span></button>
                    </div>
                    <svg class="timeline-ending"><use class="timeline-ending" xlink:href="#svg-ending"></use></svg>
                </div>
            </li>
            <li class="timeline-item test2">
                <div class="timeline-event">
                    <strong class="timeline-event-title">
                        Asfhh lahdow osdfha
                    </strong>
                    <div class="timeline-event-info">
                        <div class="timeline-event-details"></div>
                        <div class="timeline-event-summary">
                            <div class="staging-events-campaign-objects-count">11</div>
                        </div>
                    </div>
                    <div class="timeline-event-actions">
                        <button type="button" disabled class="timeline-action _tostart"><span>To start</span></button>
                        <button type="button" disabled class="timeline-action _toend"><span>To end</span></button>
                    </div>
                    <svg class="timeline-ending"><use class="timeline-ending" xlink:href="#svg-ending"></use></svg>
                </div>
            </li>
            <li class="timeline-item test6">
                <div class="timeline-event">
                    <strong class="timeline-event-title">
                        Sign-up and Save
                    </strong>
                    <div class="timeline-event-info">
                        <div class="timeline-event-details"></div>
                        <div class="timeline-event-summary">
                            <div class="staging-events-campaign-objects-count">11</div>

                        </div>
                    </div>
                    <div class="timeline-event-actions">
                        <button type="button" disabled class="timeline-action _tostart"><span>To start</span></button>
                        <button type="button" disabled class="timeline-action _toend"><span>To end</span></button>
                    </div>
                    <svg class="timeline-ending"><use class="timeline-ending" xlink:href="#svg-ending"></use></svg>
                </div>
            </li>
            <li class="timeline-item test4">
                <div class="timeline-event">
                    <strong class="timeline-event-title">
                        Registration bonus
                    </strong>
                    <div class="timeline-event-info">
                        <div class="timeline-event-details"></div>
                        <div class="timeline-event-summary">
                            <div class="staging-events-campaign-objects-count">11</div>
                        </div>
                    </div>
                    <div class="timeline-event-actions">
                        <button type="button" disabled class="timeline-action _tostart"><span>To start</span></button>
                        <button type="button" disabled class="timeline-action _toend"><span>To end</span></button>
                    </div>
                    <svg class="timeline-ending"><use class="timeline-ending" xlink:href="#svg-ending"></use></svg>
                </div>
            </li>
            <li class="timeline-item test5">
                <div class="timeline-event">
                    <strong class="timeline-event-title">
                        Registration bonus
                    </strong>
                    <div class="timeline-event-info">
                        <div class="timeline-event-details"></div>
                        <div class="timeline-event-summary">
                            <div class="staging-events-campaign-objects-count">11</div>
                        </div>
                    </div>
                    <div class="timeline-event-actions">
                        <button type="button" disabled class="timeline-action _tostart"><span>To start</span></button>
                        <button type="button" disabled class="timeline-action _toend"><span>To end</span></button>
                    </div>
                    <svg class="timeline-ending"><use class="timeline-ending" xlink:href="#svg-ending"></use></svg>
                </div>
            </li>
            <li class="timeline-item test3">
                <div class="timeline-event">
                    <strong class="timeline-event-title">
                        Design Change
                    </strong>
                    <div class="timeline-event-info">
                        <div class="timeline-event-details"></div>
                        <div class="timeline-event-summary">
                            <div class="staging-events-campaign-objects-count">11</div>
                        </div>
                    </div>
                    <div class="timeline-event-actions">
                        <button type="button" disabled class="timeline-action _tostart"><span>To start</span></button>
                        <button type="button" disabled class="timeline-action _toend"><span>To end</span></button>
                    </div>
                    <svg class="timeline-ending"><use class="timeline-ending" xlink:href="#svg-ending"></use></svg>
                </div>
            </li>
        </ul>
    </div>
    <!-- Start: data slider -->

    <!-- End: data slider -->
    <div class="timeline-scale">
        <div class="data-slider">
            <span class="data-slider-handle" tabindex="0" style="left: 25%;"></span>
            <span class="data-slider-from">1w</span>
            <span class="data-slider-to">4w</span>
        </div>
    </div>
</div>
<label for="demo-range">Demo scale timeline</label>
<input type="range" id="demo-range" data-role="scale" value="1" min="1" max="4" step="0.5" />

<script>
    require([
        "jquery"
    ], function($){

        function demo(scale) {
            if(100/7/scale * $('.timeline-unit').length < 100 ) {
                scale = $('.timeline-unit').length / 7;
            }
            $('.timeline-unit').css('width',100/7/scale + '%');
            var scale = scale,
                range = $('.timeline-unit').length,
                dayWidth = function(days,scale) {
                    if(days < range) {
                        return 100/7/scale * days + '%';
                    } else {
                        return 100/7/scale * (range + 1) + 0.000001 + '%';
                    }
                },
                dayStart = function(days,scale) {
                    return 100/7/scale * days + '%';
                };
                $('.test0').css('width', dayWidth(range + 1, scale)).css('margin-left', dayStart(-1, scale)).addClass('_permanent').addClass('_active');
                $('.test1').css('width', dayWidth(1, scale)).css('margin-left', dayStart(3, scale));
                $('.test2').css('width', dayWidth(7.5, scale)).css('margin-left', dayStart(1.5, scale));
                $('.test3').css('width', dayWidth(range - 5 + 1, scale)).css('margin-left', dayStart(4, scale)).addClass('_permanent');
                $('.test4').css('width', dayWidth(range - 5 + 1, scale)).css('margin-left', dayStart(-1, scale)).addClass('_active');
                $('.test5').css('width', dayWidth(3, scale)).css('margin-left', dayStart(8, scale));
                $('.test6').css('width', dayWidth(range + 1 - 15, scale)).css('margin-left', dayStart(14, scale)).addClass('_permanent');
        }

        function stickEdges(el) {
            var leftEdge = $(el).offset().left - $('.timeline-content').offset().left,
                rightEdge = leftEdge + $(el).width() - $('.timeline-content').width(),
                offscreen = (Math.abs($(el).offset().left) > $(el).width());

                    if (leftEdge < 0 && !offscreen) {
                        $(".timeline-event", el).css('left', - leftEdge + "px");
                        $(el).addClass('_scroll-start');
                    } else {
                        $(".timeline-event", el).css('left', '-1px');
                        $(el).removeClass('_scroll-start');
                    }
                    if (rightEdge > 0 && !offscreen) {
                        $(".timeline-event", el).css('right', rightEdge + "px");
                        $(el).addClass('_scroll-end');
                    } else {
                        $(".timeline-event", el).css('right', '0');
                        $(el).removeClass('_scroll-end');
                    }
        }


        var showTooltip = function(event) {
            $('#date-tooltip').removeClass('_hide').addClass('_show').css({
                'margin-top': '-100px',
                'margin-left': - $('#date-tooltip').width()/2 + 'px'});
            changeTooltipPosition(event);
        };
        var changeTooltipPosition = function(event) {
            var tooltipX = event.pageX;
            var tooltipY = event.pageY;
            $('#date-tooltip').css({top: tooltipY, left: tooltipX});
        };
        var hideTooltip = function() {
            $('#date-tooltip').addClass('_hide').removeClass('_show');
        };
        $(".timeline-unit").bind({
            mousemove : changeTooltipPosition,
            mouseenter : showTooltip,
            mouseleave: hideTooltip
        });

        $(document).ready ( function() {
            demo(2);
            $('[data-role=scale').change( function(){
                //console.log($('[data-role=scale').val());
                demo($('[data-role=scale').val());
                $('.timeline-content .timeline-item').each(function (index, item) {
                    stickEdges(item);
                });
            });

            $('.timeline-content .timeline-item').each(function (index, item) {
                stickEdges(item);
            });

            var mouseX;
            var mouseY;
            $(document).mousemove( function(e) {
                mouseX = e.pageX;
                mouseY = e.pageY;
            });
            $('.timeline-event').click(function(ev) {
                $('#temp-event-details').removeClass('_hide').addClass('_show').css({
                    'top':mouseY,
                    'left':mouseX,
                    'margin-top': '30px',
                    'margin-left': - $('#temp-event-details').width()/2 + 'px'});
            })
            $('.data-tooltip-wrapper .action-close').click(function(ev) {
                $('#temp-event-details').removeClass('_show').addClass('_hide');
            })

        });

        $('.timeline-content').scroll(function(){

            $('.timeline-content .timeline-item').each(function(index,item) {
                stickEdges(item);
            });
        });



        });
</script>



<!-- ToDo: this is static markup for data tooltip. The markup should be moved to appropriate file -->

<!-- Start: tooltip with tail -->
<div class="data-tooltip-wrapper _top _hide" id="temp-event-details">
    <!--
    Positioning the tooltip:
    Add top/bottom and right/left to the data-tooltip-wrapper div

    Positioning the tail:
    1. Add class
                 _top
                 _right
                 _bottom
                 _left
       to show the tail and to mark tooltip tail mode: on which side of the tooltip the tail should be.
       Add style="" to move the tail right/left or top/bottom along the tooltip side.
       By default the tail is centered on each side in each mode.
       The tail is hidden by default.
    -->

    <div class="data-tooltip">
        <!-- Tooltip actions -->
        <div class="data-tooltip-actions">
            <button type="button" class="action-close" title="<?php echo $block->escapeHtml(__('Close')) ?>">
                <span><?php /* @noEscape */ echo __('Close'); ?></span>
            </button>
        </div>

        <!-- Tooltip title -->
        <div class="data-tooltip-title">
            15% off In-Store & Online
        </div>

        <!-- Tooltip content -->
        <div class="data-tooltip-content">
            <div class="staging-events-actions">
                <button type="button" class="action-secondary action-edit">
                    <span><?php /* @noEscape */ echo __('Edit'); ?></span>
                </button>
                <button type="button" class="action-secondary action-preview">
                    <span><?php /* @noEscape */ echo __('Preview'); ?></span>
                </button>
            </div>

            <dl class="staging-events-summary">
                <dt>Status:</dt>
                <dd>Upcoming</dd>
                <dt>Start:</dt>
                <dd>01/22/2015 <span>(Will be active in 5 days)</span></dd>
            </dl>

            <div class="staging-events-campaign">
                <div class="staging-events-campaign-objects">
                    This campaign includes
                    <div class="staging-events-campaign-objects-count">11 Objects</div>
                </div>
                <ul class="items">
                    <li class="item"><a href="#">6 Products</a></li>
                    <li class="item"><a href="#">2 Categories</a></li>
                    <li class="item"><a href="#">2 Customer segments</a></li>
                    <li class="item"><a href="#">1 CMS Page - "About Us"</a></li>
                </ul>
            </div>
            <div class="staging-events-delete">
                <button type="button" class="action-tertiary action-delete">
                    <span><?php /* @noEscape */ echo __('Delete this Update'); ?></span>
                </button>
            </div>
        </div>
    </div>
    <div class="data-tooltip-tail"></div>
</div>
<!-- End: tooltip with tail -->

<!-- Start: tooltip with tail -->



    <div class="data-tooltip-wrapper _top _hide">
        <div class="data-tooltip-tail"></div>
        <div class="data-tooltip">
            <!-- Tooltip actions -->
            <div class="data-tooltip-actions">
                <button type="button" class="action-close" title="<?php echo $block->escapeHtml(__('Close')) ?>">
                    <span><?php /* @noEscape */ echo __('Close'); ?></span>
                </button>
            </div>

            <!-- Tooltip content -->
            <div class="data-tooltip-content">
                <ul class="items">
                    <li class="item"><a href="#">6 Products</a></li>
                    <li class="item"><a href="#">2 Categories</a></li>
                    <li class="item"><a href="#">2 Customer segments</a></li>
                    <li class="item"><a href="#">1 CMS Page - "About Us"</a></li>
                </ul>
            </div>
        </div>
    </div>

<!-- End: tooltip with tail -->

<!-- Start: tooltip with tail -->
<div class="data-tooltip-wrapper _bottom _hide" id="date-tooltip">
    <div class="data-tooltip-tail"></div>
    <div class="data-tooltip">
        <!-- Tooltip content -->
        <div class="data-tooltip-content">
            Fri 02/07/2015
        </div>
    </div>
</div>
<!-- End: tooltip with tail -->
