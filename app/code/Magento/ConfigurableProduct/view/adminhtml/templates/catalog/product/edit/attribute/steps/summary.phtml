<?php
/**
 * Copyright Â© 2015 Magento. All rights reserved.
 * See COPYING.txt for license details.
 */

// @codingStandardsIgnoreFile

/* @var $block \Magento\ConfigurableProduct\Block\Adminhtml\Product\Steps\Summary */
?>
<div data-bind="scope: '<?= $block->getComponentName()?>'">
    <h2 class="steps-wizard-title"><?= __('Step 4: Summary') ?></h2>
    <div class="steps-wizard-info">
        <span><?= __('Here are all the products you are going to create. ') ?></span>
    </div>

    <table class="data-grid-configurable">
        <thead>
            <tr>
                <!-- ko foreach: attributesName -->
                <th style="
                    border: none;
                    text-transform: capitalize;
                    background-color: gray;
                    color: white;
                    padding: 13px;
                    font-size: small;
                " data-bind="text: $data"></th>
                <!-- /ko -->
            </tr>
            <tr style="height: 5px;"></tr>
        </thead>
        <tbody data-bind="foreach: grid">
            <tr data-bind="style: {backgroundColor: $index() % 2 ? 'whitesmoke' : 'white'}">
                <!-- TEMP: START: MAGETWO-37241: Icon for the number of uploaded images markup -->
                <td class="col-image">
                    <div class="images-uploaded">
                        <img src="image.jpg" alt="Product title" width="50" height="50">
                        <span>555</span><!-- the number of uploaded images -->
                    </div>
                </td>
                <!-- END: MAGETWO-37241: Icon for the number of uploaded images markup -->

                <!-- ko foreach: $data -->
                <!-- ko if: $data && $data.preview -->
                <td style="padding: 10px;text-align: center;border-left: 2px solid grey; width: 10%">
                    <img data-bind='attr: {src: $data.preview}' />
                </td>
                <!-- /ko -->
                <!-- ko ifnot: $data && $data.preview -->
                <td style="padding: 10px;text-align: center;border-left: 2px solid grey;">
                    <span data-bind='text: $data'></span>
                </td>
                <!-- /ko -->
                <!-- /ko -->
            </tr>
        </tbody>
    </table>

    <div style="display: none" data-role="product-variations-matrix-tmp">
        <script data-template-for="variation-image" type="text/x-magento-template">
            <img src="<%- data.url %>" class="variation" data-role="image"/>
        </script>
        <div class="field">
            <div data-role="configurable-attribute">
                <!-- ko foreach: {data: attributes, as: 'attribute'} -->
                <input name="attributes[]" data-bind="value: attribute.id, attr:{id: 'configurable_attribute_' + attribute.id}" type="hidden"/>
                <input data-bind="value: attribute.id, attr: {name: $parent.getAttributeRowName(attribute, 'attribute_id')}" type="hidden"/>
                <input data-bind="value: attribute.code, attr: {name: $parent.getAttributeRowName(attribute, 'code')}" type="hidden"/>
                <input data-bind="value: attribute.label, attr: {name: $parent.getAttributeRowName(attribute, 'label')}" type="hidden"/>
                <input data-bind="value: $index(), attr: {name: $parent.getAttributeRowName(attribute, 'position')}" type="hidden"/>
                <!-- ko foreach: {data: attribute.chosen, as: 'option'} -->
                <input value="1" data-bind="attr: {name: $parents[1].getOptionRowName(attribute, option, 'include')}" type="hidden"/>
                <input data-bind="value: option.value, attr: {name: $parents[1].getOptionRowName(attribute, option, 'value_index')}" type="hidden"/>
                <!-- /ko -->
                <!-- /ko -->
            </div>
            <div class="control">
                <table class="admin__table-secondary">
                    <thead>
                    <tr>
                        <th class="col-display" data-column="display">
                            <?= __('Display'); ?>
                        </th>
                        <th class="col-image" data-column="image">
                            <?= __('Image'); ?>
                        </th>
                        <th class="col-name"  data-column="name">
                            <?= __('Name'); ?>
                        </th>
                        <th class="col-sku" data-column="sku">
                            <?= __('SKU'); ?>
                        </th>
                        <th class="col-price" data-column="price">
                            <?= __('Price'); ?>
                        </th>
                        <th class="col-qty" data-column="qty">
                            <?= __('Quantity'); ?>
                        </th>
                        <th class="col-weight" data-column="weight">
                            <?= __('Weight'); ?>
                        </th>
                        <!-- ko if: productMatrix()[0] -->
                        <!-- ko foreach: productMatrix()[0].options -->
                        <th data-bind="attr: {class:'col-' + $data.attribute_code}, text: $data.attribute_label"></th>
                        <!-- /ko -->
                        <!-- /ko -->
                    </tr>
                    </thead>
                    <tbody data-bind="foreach: {data: productMatrix, as: 'variation'}">
                    <tr data-role="row" data-bind="attr: {class:  $index() % 2 ? 'even' : ''}">
                        <td class="col-display" data-column="display">
                            <input type="checkbox" name="associated_product_ids[]" value="" class="checkbox" data-column="entity_id" checked="checked"/>
                        </td>
                        <td class="col-image" data-column="image">
                            <div class="actions split actions-image-uploader">
                                <!-- ko ifnot: variation.images -->
                                <div class="action-upload action split" data-action="upload-image">
                                    <input type="hidden" data-bind="attr: {id: $parent.getRowId(variation, 'image'), name: $parent.getVariationRowName(variation, 'image')}"/>
                                    <span><?= __('Upload Image'); ?></span>
                                    <input name="image" type="file"
                                           data-url="<?= $block->escapeHtml($block->getImageUploadUrl()) ?>"
                                           title="<?= __('Upload Image');
                                           ?>"/>
                                </div>
                                <button type="button" class="action toggle no-display" data-toggle="dropdown"
                                        data-mage-init='{"dropdown":{}}'>
                                    <span><?= __('Select'); ?></span>
                                </button>
                                <!-- /ko -->
                                <!-- ko if: variation.images -->
                                    <img data-bind='attr: {src: variation.images.preview}' class="variation" data-role="image" />
                                    <span data-bind="html: $parent.generateImageGallery(variation)"></span>
                                <!-- /ko -->
                                <ul class="dropdown">
                                    <li>
                                        <a class="item" data-action="no-image"><?= __('No Image'); ?></a>
                                    </li>
                                </ul>
                            </div>
                        </td>
                        <td class="col-name" data-column="name">
                            <input type="text"
                                   data-bind="attr: {id: $parent.getRowId(variation, 'name'), name: $parent.getVariationRowName(variation, 'name'), value: variation.sku}"/>
                            <input type="hidden"
                                   data-bind="attr: {id: $parent.getRowId(variation, 'configurable_attribute'), name: $parent.getVariationRowName(variation, 'configurable_attribute'), value: variation.attribute}"/>
                            <button type="button" data-action="choose" class="action-choose" title="<?= __('Choose'); ?>"
                                    data-bind="attr: {'data-attributes': variation.attribute}">
                                <span><?= __('Choose'); ?></span>
                            </button>
                        </td>
                        <td class="col-sku" data-column="sku">
                            <input type="text"
                                   data-bind="attr: {id: $parent.getRowId(variation, 'sku'), name: $parent.getVariationRowName(variation, 'sku'), value: variation.sku}"/>
                        </td>
                        <td class="col-price" data-column="price">
                            <div class="addon">
                                <input type="text" id="" class="validate-zero-or-greater" data-bind="attr: {id: $parent.getRowId(variation, 'price'), name: $parent.getVariationRowName(variation, 'price'), value: variation.price}"/>
                                <label class="addafter" data-bind="attr: {for: $parent.getRowId(variation, 'price')"><strong>$</strong></label>
                            </div>
                        </td>
                        <td class="col-qty" data-column="qty">
                            <input type="text" class="validate-number" data-bind="attr: {id: $parent.getRowId(variation, 'qty'), name: $parent.getVariationRowName(variation, 'quantity_and_stock_status/qty'), value: variation.inventory}"/>
                        </td>
                        <td class="col-weight" data-column="weight">
                            <input type="text" data-bind="attr: {id: $parent.getRowId(variation, 'weight'), name: $parent.getVariationRowName(variation, 'weight'), value: variation.weight}"/>
                        </td>
                        <!-- ko foreach: variation.options -->
                        <td data-bind="text: label"></td>
                        <!-- /ko -->
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<script type="text/x-magento-init">
    {
        "*": {
            "Magento_Ui/js/core/app": {
                "components": {
                    "<?= $block->getComponentName()?>": {
                        "component": "Magento_ConfigurableProduct/js/variations/steps/summary",
                        "appendTo": "<?= $block->getParentComponentName()?>"
                    }
                }
            }
        }
    }
</script>
